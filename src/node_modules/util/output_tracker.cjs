// Copyright Titanium I.T. LLC.
const ensure = require("util/ensure");
const EventEmitter = require("node:events");

module.exports = class OutputTracker {

	static create(emitter, event) {
		ensure.signature(arguments, [ EventEmitter, String ]);

		return new OutputTracker(emitter, event);
	}

	constructor(emitter, event) {
		this._emitter = emitter;
		this._event = event;
		this._data = [];

		this._trackerFn = (text) => this._data.push(text);
		this._emitter.on(this._event, this._trackerFn);
	}

	get data() {
		return this._data;
	}

	clear() {
		ensure.signature(arguments, []);

		const result = [ ...this._data ];
		this._data.length = 0;
		return result;
	}

	stop() {
		ensure.signature(arguments, []);

		this._emitter.off(this._event, this._trackerFn);
	}

};